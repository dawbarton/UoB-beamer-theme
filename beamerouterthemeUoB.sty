%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% University of Bristol presentation theme based on the PowerPoint template
%
% Copyright (c) 2012, David A.W. Barton (david.barton@bristol.ac.uk)
% All rights reserved.
%
% The latest version of this theme can be found at
%   https://github.com/db9052/UoB-beamer-theme
% 
% Redistribution and use in source and binary forms, with or without
% modification, are permitted provided that the following conditions are met:
%     * Redistributions of source code must retain the above copyright
%       notice, this list of conditions and the following disclaimer.
%     * Redistributions in binary form must reproduce the above copyright
%       notice, this list of conditions and the following disclaimer in the
%       documentation and/or other materials provided with the distribution.
%     * Neither the name of the <organization> nor the
%       names of its contributors may be used to endorse or promote products
%       derived from this software without specific prior written permission.
% 
% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
% ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
% WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
% DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
% DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
% (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
% LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
% ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
% (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
% SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\mode<presentation>

\usepackage{calc}

% Lengths
\newlength{\margin}
\newlength{\textmargin}
\ifbeamer@compress
  \setlength{\margin}{2mm}
  \setlength{\textmargin}{4mm}
\else
  \setlength{\margin}{5mm}
  \setlength{\textmargin}{5mm}
\fi
\newlength{\logowidth}
\setlength{\logowidth}{28mm}

% Margins
\setbeamersize{text margin left=\textmargin,text margin right=\textmargin}

% UoB images
\pgfdeclareimage[width=\logowidth]{UoBlogo}{UoB-logo}
\pgfdeclareimage{UoBurl}{UoB-url}

% Headline
\defbeamertemplate*{headline}{UoB}{
  \vskip\margin
  \hskip\margin
  \pgfuseimage{UoBlogo}
  \parbox[b]{\paperwidth-2\margin-\logowidth}{
    \raggedleft
    \ifnum\c@page=1\else\insertshorttitle\\[1mm]\fi
    \insertdate
  }
  \par
  \vskip0.7\margin
  \hskip\margin
  \begin{pgfpicture}
    \pgfsetstrokecolor{normal text.fg}
    \pgfsetlinewidth{1pt}
    \pgfpathmoveto{\pgfpointorigin}
    \pgfpathlineto{\pgfpoint{\paperwidth-2\margin}{0mm}}
    \pgfsetroundcap
    \pgfsetdash{{0pt}{2pt}}{0pt}
    \pgfusepath{stroke}
  \end{pgfpicture}
}

% Footline
\defbeamertemplate*{footline}{UoB}{
  \ifbeamer@nourl
  \else
    \hskip\margin
    \begin{pgfpicture}
      \pgfsetlinewidth{1pt}
      \pgfpathmoveto{\pgfpointorigin}
      \pgfpathlineto{\pgfpoint{\paperwidth-2\margin}{0mm}}
      \pgfsetroundcap
      \pgfsetdash{{0pt}{2pt}}{0pt}
      \pgfusepath{stroke}
    \end{pgfpicture}\vskip0.5\margin
    \par
    \hfill\pgfuseimage{UoBurl}\hskip\margin\mbox{}\vskip\margin
  \fi
}

% Frametitle
\defbeamertemplate*{frametitle}{UoB}{
  \vskip1mm
  \insertframetitle
}

% Background

\defbeamertemplate*{background canvas}{UoB}{
  \ifbeamer@nowatermark
  \else
    \ifnum\c@page=1
      \pgfuseimage{UoBwatermark}
    \fi
  \fi
}

\mode<all>
